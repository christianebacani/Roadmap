-- You can use your own database or referencing the name of my database
USE practicedb;
-- Querying the Highest Averaging Profit per country
-- And Query the total films, total profit, maximum budget, and minimum budget per country
-- Querying only top 3 highest averaging profit globally
-- Sorting them to the highest averaging profit
SELECT
	country,
    COUNT(films_film_id) AS total_film,
    SUM(gross - budget) AS total_profit,
    ROUND(AVG(gross - budget), 2) AS avg_profit,
    MAX(budget) AS maximum_budget,
    COALESCE(MIN(budget), 0) AS minimum_budget
FROM films_reviews
GROUP BY country
ORDER BY avg_profit DESC, country
LIMIT 3;
































































































    

























    
    
    
    
    












    















    


















