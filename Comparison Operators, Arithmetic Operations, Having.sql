-- You can use your own database or referencing the name of my database
USE practicedb;
-- Grouping the query per country
-- Querying the average duration per hour using arithmetic operations to convert minutes to hours
-- Querying the average profit per country using arithmethic operations to subract gross to budget
-- Sorting the country by name but the result is only one so sorting it is just redundant
-- There`s only one records because we perform filtering the aggregation using HAVING() to filter the avg_hour >= 2 and avg_profit >= 100000
SELECT
	country,
    ROUND(AVG(duration / 60), 2) AS avg_hour,
    ROUND(AVG(gross - budget), 2) AS avg_profit
FROM films_reviews
GROUP BY country
HAVING (ROUND(AVG(duration / 60), 2) >= 2.0) AND (ROUND(AVG(gross - budget), 2) >= 100000)
ORDER BY country;
































































































    

























    
    
    
    
    












    















    


















